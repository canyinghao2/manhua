<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>xxx</title>

    <script src="js/jquery-1.7.1.min.js" type="text/javascript"></script>
    <script src="js/jquery.tmpl.min.js" type="text/javascript"></script>
    <script src="./clipboard.min.js"></script>
    <!-- WPA start -->
<script id="qd2852177237e49e274192edc60bf82a0146d71ce8a2" src="https://wp.qiye.qq.com/qidian/2852177237/e49e274192edc60bf82a0146d71ce8a2" charset="utf-8" async defer></script>
<!-- WPA end -->
    <script type="text/javascript">
        //        showData();
        showTest();


        $(function () {
            var iframe = document.createElement('iframe');
            iframe.setAttribute('id', 'toApp');
            iframe.setAttribute('style', 'display:none');
            document.body.appendChild(iframe);


            var clipboard = new Clipboard('.btn');

            clipboard.on('success', function (e) {
                console.info('Action:', e.action);
                console.info('Text:', e.text);
                console.info('Trigger:', e.trigger);

                e.clearSelection();
            });

            clipboard.on('error', function (e) {
                console.error('Action:', e.action);
                console.error('Trigger:', e.trigger);
            });


            var url = location.search; //获取url中"?"符后的字串
            var str = "";
            if (url.indexOf("?") != -1) {
                str = url.substr(1);
                console.log(str);
            }

            $(".btn").attr("data-clipboard-text", "tkanmanapp://sharecomic?" + str);

        });

        function getPhoneInfo() {
            var info = {};
            var e = document.createElement("canvas");
            if (e && "function" == typeof e.getContext)
                for (var t = ["webgl", "webgl2", "experimental-webgl2", "experimental-webgl"], r = 0; r < t.length; r++) {
                    var i = t[r],
                            o = e.getContext(i);
                    if (o) {
                        var a = {};
                        a.context = i, a.version = o.getParameter(o.VERSION), a.vendor = o.getParameter(o.VENDOR), a.sl_version =
                                o.getParameter(o.SHADING_LANGUAGE_VERSION), a.max_texture_size = o.getParameter(o.MAX_TEXTURE_SIZE);
                        var c = o.getExtension("WEBGL_debug_renderer_info");
                        info = (c && (a.vendor = o.getParameter(c.UNMASKED_VENDOR_WEBGL), a.renderer = o.getParameter(c.UNMASKED_RENDERER_WEBGL)),
                                a)
                    }
                }
            return JSON.stringify(info)
        }

        function comicshare() {


            var url = location.search; //获取url中"?"符后的字串
            var str = "";
            if (url.indexOf("?") != -1) {
                str = url.substr(1);
                console.log(str);
            }

            $("#toApp").attr("src", "tkanmanapp://sharecomic?" + str);

        }

        function getshowuser() {
            $("#toApp").attr("src", "tkanmanapp://getuser?callback=showuser");
        }

        function closepage() {
            $("#toApp").attr("src", "tkanmanapp://app?callback=closepage");
        }


        function fullscreen() {
            $("#toApp").attr("src", "tkanmanapp://app?callback=fullscreen");
        }

        function normalscreen() {
            $("#toApp").attr("src", "tkanmanapp://app?callback=normalscreen");
        }

        function nopull() {
            $("#toApp").attr("src", "tkanmanapp://app?callback=nopull");
        }

        function nofloatbutton() {
            $("#toApp").attr("src", "tkanmanapp://app?callback=nofloatbutton");
        }

        function saveuser(data) {

            alert(data.uid + "  " + data.name);
        }

        function showuser(data) {
            var last = JSON.stringify(data);
            alert(last);
        }


        function share() {
            $("#toApp").attr("src", "tkanmanapp://share?title=hello&link=http%3A%2F%2Fwww.baidu.com&content=%E5%88%86%E4%BA%AB%E6%96%87%E5%AD%97&image=http%3A%2F%2Fwww.kanman.com%2Fstatic%2Fkanman_logo.png&callback=sharecallback");
        }

        function pictureshare() {
            $("#toApp").attr("src", "tkanmanapp://picture?qr=https%3A%2F%2Fwww.kanman.com%2F25934%2Fdpcq_1h.html&image=http%3A%2F%2Fmhpic.jumanhua.com%2Fcomic%2FD%2F%25E6%2596%2597%25E7%25A0%25B4%25E8%258B%258D%25E7%25A9%25B9%25E6%258B%2586%25E5%2588%2586%25E7%2589%2588%2F722%25E8%25AF%259DGQ%2F1.jpg-kmh.middle.webp&title=%E6%96%97%E7%A0%B4%E8%8B%8D%E7%A9%B9&content=%E7%AC%AC%E4%B8%80%E8%AF%9D&hint=%E9%95%BF%E6%8C%89%E8%AF%86%E5%88%AB%E4%BA%8C%E7%BB%B4%E7%A0%81&callback=picturecallback");
        }

        function newyearshare() {
            $("#toApp").attr("src", "tkanmanapp://newyear?qr=https%3A%2F%2Fgetcomicinfo-globalapi.yyhao.com%2Fapp_api%2Fv5%2Fgetcomicinfo_body%2F%3Fcomic_id%3D102876%26platformname%3Dandroid%26productname%3Daym&image=https%3A%2F%2Fcanyinghao2.github.io%2Fmanhua%2Fnewyear.png&callback=picturecallback");
        }

        function sharecallback(shareType) {
            alert("分享到成功! 类型:" + shareType);
        }

        function picturecallback(shareType) {
            alert("分享二维码成功! 类型:" + shareType);
        }

        function webtoapp() {
            $("#toApp").attr("src", "tkanmanapp://goto?page=web&url=https%3A%2F%2Fcanyinghao2.github.io%2Fmanhua%2Ftest.html");
        }

        function webtoappmht() {
            $("#toApp").attr("src", "tmanhuataiapp://goto?page=web&url=https%3A%2F%2Fcanyinghao2.github.io%2Fmanhua%2Ftest.html");
        }


        function gotoComic() {
            $("#toApp").attr("src", "tkanmanapp://goto?page=dir&comic_id=25934");

        }


        function baiduinapp() {
            $("#toApp").attr("src", "tkanmanapp://goto?page=dir&comic_id=25934&inbaidu=ture#Intent;component=com.wbxm.icartoon/.ui.detail.DetailActivity;S.intent_id=25934;end");
        }


        function rigeng() {
            $("#toApp").attr("src", "tkanmanapp://goto?page=sortlist&class_id=137");
        }
        function classification() {
            $("#toApp").attr("src", "tkanmanapp://goto?page=classification");
        }


        function dir() {
            $("#toApp").attr("src", "tkanmanapp://goto?page=dir&comic_id=25933&chapter_id=49872");
        }

        function dirH5() {
            $("#toApp").attr("src", "tkanmanapp://goto?page=dir&comic_id=106499&chapter_id=1549367");
        }


        function novelGril() {
            $("#toApp").attr("src", "tkanmanapp://goto?page=novel&tab=1");
        }

        function novelDetail() {
            $("#toApp").attr("src", "tkanmanapp://goto?page=noveldetail&novel_id=50001832");
        }

        function novelBook() {
            $("#toApp").attr("src", "tkanmanapp://goto?page=novelbook&novel_bookid=102");
        }

        function novelrank() {
            $("#toApp").attr("src", "tkanmanapp://goto?page=novelrank");
        }
        function openBrowser() {
            $("#toApp").attr("src", "tkanmanapp://browser");
        }

        function openBrowserurl() {
            $("#toApp").attr("src", "tkanmanapp://browser?url=https%3A%2F%2Fwww.baidu.com");
        }

        function novelclassify() {
            $("#toApp").attr("src", "tkanmanapp://goto?page=novelclassify");
        }
        function isInstall() {
            $("#toApp").attr("src", "tkanmanapp://isInstallApp?package=com.comic.manhuatai&callback=isInstallCallBack");
        }

        function openApp() {
            $("#toApp").attr("src", "tkanmanapp://openApp?package=com.comic.manhuatai");
        }

        function isInstallCallBack(pkg, isInstall) {
            alert("是否安装:" + pkg + "   " + (isInstall == 1 ? "是" : "否"));
        }

        function getShareConf() {
            return {
                title: 'h5活动页',
                content: 'h5活动页描述',
                image: 'https://www.baidu.com/img/bd_logo1.png',
                url: 'http://www.baidu.com',
                callback: "sharecallback"
            }
        }


        function showTest() {

            var data = {
                '热血': 14.567049752581676,
                '神魔': 10.665062317160656,
                '玄幻': 13.202595639420462,
                '漫改': 10.516764154067609,
                '修真': 9.56606105590134,
                '精品': 11.397808410639652,
                '冒险': 5.549361156460864,
                '穿越': 3.022322374129381,
                '恋爱': 7.088013268824628,
                '战争': 0.8343077492124656,
                '游戏': 0.8534362948479048,
                '搞笑': 2.3922022827086837,
                '动作': 0.9469372785073371,
                '都市': 2.1875639934372844,
                '霸总': 1.468004360320394,
                '生活': 1.3011325498033244,
                '古风': 1.975000373397096,
                '历史': 0.32064386187867194,
                '日更': 0.3394214755245086,
                '武侠': 0.4342446015657062,
                '运动': 0.1904877566850363,
                '新作': 0.17304662560239387,
                '社会': 0.21921321050895354,
                '推理': 0.16175056324844844,
                '悬疑': 0.46400951446525646,
                '恐怖': 0.037989291974012455,
                '竞技': 0.026153170954006294,
                '科幻': 0.06849943940784271,
                '宠物': 0.01772502175498042,
                '杂志': 0.005806406498399261,
                '机战': 0.003736576086532919,
                '真人': 0.0034994055839174094,
                '萝莉': 0.00015006684057410638
            };

            var result = {};
            var rs = [];
            var i = 0;
            for (var key in data) {
//               var str =  data[key]+"";
//               str =  str.substr(0,5)+"%";
//                result[key] = str;
                if (key !== "精品") {
                    rs[i] = {key: key, value: data[key]}
                    i++;
                }


            }

            rs = rs.sort(function (a, b) {
                return b.value - a.value;
            });
            rs = rs.slice(0, 5);
            rs.forEach(function (a) {
                var key = a.key;
                var str = a.value + "";
                str = str.substr(0, 5) + "%";
                result[key] = str;

            });


//            console.log(result)
            var str = JSON.stringify(result);
            str = str.replace(/:/g, "：");
            str = str.replace(/"/g, "");
//            document.write(str);
//            document.write(JSON.stringify(rs))


        }

        function showData() {
            var json = [
                {
                    ciyuan: 2355658.4000,
                    zuanshi: 57423048,
                },
                {
                    ciyuan: 1234775.5000,
                    zuanshi: 42022477,
                },
                {
                    ciyuan: 390162.2000,
                    zuanshi: 11565493,
                }, {
                    ciyuan: 131961.8000,
                    zuanshi: 3845252,
                }, {
                    ciyuan: 0,
                    zuanshi: 10093,
                }


            ];

//            json.forEach((item, index) = > {
//                console.log(item.ciyuan + item.zuanshi / 100);
//        })
//            ;

        }



    </script>
</head>
<body>


<a class="btn" href="javascript:webtoapp()">看漫app内打开此页面</a><br/><br/>
<a class="btn" href="javascript:webtoappmht()">漫画台app内打开此页面</a><br/><br/>

<a class="btn" href="javascript:fullscreen()">全屏</a><br/>
<a class="btn" href="javascript:normalscreen()">非全屏</a><br/>
<a class="btn" href="javascript:closepage()">退出</a><br/><br/>
<a class="btn" href="javascript:nopull()">不允许下拉</a><br/>
<a class="btn" href="javascript:nofloatbutton()">不显示浮动按钮</a><br/><br/>


<a class="btn" href="javascript:getshowuser()">获取用户信息</a><br/>
<a class="btn" href="javascript:share()"> 分享</a><br/>
<a class="btn" href="javascript:pictureshare()"> 分享二维码</a><br/>
<a class="btn" href="javascript:newyearshare()"> 新年签二维码</a><br/>
<a class="btn" href="javascript:gotoComic()"> 打开漫画</a><br/><br/>

<a class="btn"
   href="http://static.321mh.com/html/video/index.html?title=%E6%AF%95%E4%B8%9A%E5%AD%A3&file=yljs_01.mp4&cover=yljs_01.jpg">
    播放动态漫画视频</a><br/><br/>


<a class="btn" href="javascript:rigeng()">日更</a><br/>
<a class="btn" href="javascript:classification()">分类</a><br/>
<a class="btn" href="javascript:dir()"> 打开阅读页</a><br/>
<a class="btn" href="javascript:dirH5()"> 打开H5阅读页</a><br/><br/>


<a class="btn" href="javascript:novelGril()"> 小说女生频道</a><br/>
<a class="btn" href="javascript:novelDetail()"> 小说详情页</a><br/>
<a class="btn" href="javascript:novelBook()"> 小说书单页</a><br/>
<a class="btn" href="javascript:novelclassify()"> 小说分类</a><br/>
<a class="btn" href="javascript:novelrank()"> 小说排行榜</a><br/>
<a class="btn" href="javascript:openBrowser()">在浏览器中打开</a><br/>
<a class="btn" href="javascript:openBrowserurl()">在浏览器中打开自定义url</a><br/>

<a class="btn" href="javascript:isInstall()"> 是否安装漫画台</a><br/>
<a class="btn" href="javascript:openApp()"> 打开漫画台</a><br/>

<a class="btn" href="https://jq.qq.com/?_wv=1027&k=53BticN">测试加群</a><br/>
<a class="btn" href="http://qm.qq.com/cgi-bin/qm/qr?k=E40LS8J3nCxkx6UOoP3KahroNr9MsYEE">测试加群</a><br/>
<a  href="javascript:getPhoneInfo()">获取手机信息</a><br/>


</body>
</html>